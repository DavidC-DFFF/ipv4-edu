<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Adressage IPv4 ‚Äì site p√©dagogique</title>
    <style>
        :root {
            --bg: #0b1220;
            --fg: #e6ecf2;
            --muted: #93a1b6;
            --card: #0f172a;
            --accent: #4cc9f0;
            --danger: #ff6b6b;
            --sep: #334155;
            --net: #15a34a;
            /* vert NetID */
            --host: #ef4444;
            /* rouge HostID */
            --ghost: #0b1220;
        }

        html.light:root {
            --bg: #f7fafc;
            --fg: #0b1220;
            --muted: #42536f;
            --card: #ffffff;
            --accent: #2563eb;
            --danger: #b91c1c;
            --sep: #cbd5e1;
            --net: #15803d;
            --host: #b91c1c;
            --ghost: #ffffff;
        }

        * {
            box-sizing: border-box
        }

        body {
            margin: 0;
            background: var(--bg);
            color: var(--fg);
            font: 16px/1.45 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial
        }

        .wrap {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px
        }

        header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            padding: 14px 20px;
            border-bottom: 1px solid var(--sep);
            position: sticky;
            top: 0;
            background: linear-gradient(180deg, var(--bg), rgba(0, 0, 0, 0))
        }

        h1 {
            font-size: clamp(22px, 3vw, 28px);
            margin: 0
        }

        .btn {
            cursor: pointer;
            background: var(--accent);
            border: none;
            color: #001628;
            padding: 10px 14px;
            border-radius: 12px;
            font-weight: 700
        }

        .btn.ghost {
            background: transparent;
            color: var(--fg);
            border: 1px solid var(--sep)
        }

        .btn:disabled {
            opacity: .45;
            filter: saturate(.2);
            cursor: not-allowed
        }

        /* Layout */
        .layout {
            display: grid;
            grid-template-columns: 260px 1fr;
            gap: 16px
        }

        @media(max-width:880px) {
            .layout {
                grid-template-columns: 1fr
            }
        }

        /* Sidebar */
        .sidebar {
            background: var(--card);
            border: 1px solid var(--sep);
            border-radius: 14px;
            padding: 14px
        }

        .sidebar h2 {
            margin: 0 0 10px;
            font-size: 18px
        }

        .row {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
            margin: 8px 0
        }

        label {
            font-weight: 600
        }

        input[type=text],
        input[type=number] {
            background: #0000;
            border: 1px solid var(--sep);
            border-radius: 10px;
            color: var(--fg);
            padding: 9px 10px;
            min-width: 160px
        }

        input:focus {
            outline: 2px solid var(--accent)
        }

        .muted {
            color: var(--muted);
            font-size: 12px
        }

        .class-btns {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 8px;
            margin: 8px 0
        }

        .class-btns button {
            background: #0ea5e9;
            color: #00101a
        }

        .toggle {
            display: flex;
            align-items: center;
            gap: 8px
        }

        /* Center hero */
        .stage {
            background: var(--card);
            border: 1px solid var(--sep);
            border-radius: 16px;
            padding: 18px;
            display: grid;
            gap: 16px;
            align-content: start
        }

        .hero {
            display: grid;
            gap: 8px;
            place-items: center;
            text-align: center
        }

        .big {
            font-size: clamp(28px, 6vw, 56px);
            font-weight: 800;
            letter-spacing: 0.5px
        }

        .big .oct {
            width: 3.5ch;
            min-width: 3.5ch;
            max-width: 3.5ch;
            text-align: center;
            padding: 0;
            border-radius: 10px;
            display: inline-block;
            margin: 0 2px;
            font-variant-numeric: tabular-nums
        }

        .big .oct.net {
            color: var(--net);
            border: 1px solid color-mix(in srgb, var(--net) 65%, var(--sep));
            background: color-mix(in srgb, var(--net) 14%, var(--ghost))
        }

        .big .oct.host {
            color: var(--host);
            border: 1px solid color-mix(in srgb, var(--host) 60%, var(--sep));
            background: color-mix(in srgb, var(--host) 12%, var(--ghost))
        }

        .big .oct.mix {
            color: var(--fg);
            border: 1px solid var(--sep);
            background: linear-gradient(90deg, color-mix(in srgb, var(--net) 30%, transparent) var(--mixp), color-mix(in srgb, var(--host) 30%, transparent) var(--mixp));
        }

        .big .oct.sep {
            width: auto;
            min-width: 0;
            max-width: none;
            padding: 0 6px;
            border: 0;
            background: transparent;
            color: var(--fg)
        }

        .mono {
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
            font-variant-numeric: tabular-nums
        }

        /* Binary lines */
        .bin-line {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center
        }

        .bin-oct {
            display: flex;
            gap: 4px;
            align-items: center
        }

        .oct-sep {
            font-weight: bold;
            margin: 0 4px
        }

        .bit {
            width: 18px;
            height: 22px;
            min-width: 18px;
            text-align: center;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            border: 1px solid var(--sep);
            font-size: 12px
        }

        .bit.net {
            background: color-mix(in srgb, var(--net) 22%, transparent);
            color: var(--fg);
            border-color: color-mix(in srgb, var(--net) 60%, var(--sep))
        }

        .bit.host {
            background: color-mix(in srgb, var(--host) 22%, transparent);
            color: var(--fg);
            border-color: color-mix(in srgb, var(--host) 60%, var(--sep))
        }

        .legend {
            display: flex;
            gap: 12px;
            align-items: center;
            justify-content: center;
            color: var(--muted);
            font-size: 13px
        }

        .pill {
            height: 10px;
            width: 16px;
            border-radius: 4px;
            display: inline-block;
            border: 1px solid var(--sep)
        }

        .pill.net {
            background: var(--net)
        }

        .pill.host {
            background: var(--host)
        }

        .cidr {
            margin-left: 10px;
            font-weight: 800;
            opacity: .9
        }

        .footer {
            color: var(--muted);
            font-size: 12px;
            margin-top: 14px
        }
    </style>
</head>

<body>
    <header class="wrap">
        <h1>Adressage IPv4 ‚Äî visualiser NetID / HostID</h1>
        <button id="toggleTheme" class="btn ghost" title="Mode clair/sombre">üåó</button>
    </header>

    <main class="wrap layout">
        <!-- LEFT: classe / saisie -->
        <aside class="sidebar">
            <h2>Classes</h2>
            <div class="class-btns">
                <button class="btn" id="btnA">Classe A</button>
                <button class="btn" id="btnB">Classe B</button>
                <button class="btn" id="btnC">Classe C</button>
            </div>
            <div class="muted">Cliquez pour g√©n√©rer une adresse al√©atoire de cette classe et appliquer le masque par
                d√©faut.</div>
            <div class="row" style="margin-top:10px">
                <label for="ip">Adresse :</label>
                <input id="ip" type="text" placeholder="ex. 192.168.10.42" />
            </div>
            <div class="row">
                <span class="muted">Classe d√©tect√©e¬†:</span>
                <span id="classTag" class="muted">‚Äî</span>
            </div>
            <div class="row toggle">
                <input type="checkbox" id="classless" />
                <label for="classless">Mode classless (CIDR)</label>
            </div>
            <div class="row">
                <label for="netbits">Bits NetID :</label>
                <input id="netbits" type="number" min="0" max="32" value="24" disabled style="width:90px" />
            </div>
            <div class="muted">En mode classless, choisissez un pr√©fixe (ex. 20). Sinon, le masque par d√©faut des
                classes A/B/C est appliqu√© (8/16/24).</div>
        </aside>

        <!-- CENTER: Hero display -->
        <section class="stage">
            <div class="hero">
                <div class="big mono" id="ipRow"><span id="ipDec"></span><span id="cidr" class="cidr">/24</span></div>
                <div class="legend"><span class="pill net"></span> NetID <span class="pill host"></span> HostID</div>
                <div class="bin-line mono" id="ipBin"></div>
                <div style="height:1px;background:var(--sep);width:100%"></div>
                <div class="big mono" id="maskDec"></div>
                <div class="bin-line mono" id="maskBin"></div>
            </div>
        </section>
    </main>

    <div class="wrap footer">¬© 2025 ‚Äî Ressource p√©dagogique libre. Utilisation en classe encourag√©e.</div>

    <script>
        window.addEventListener('DOMContentLoaded', () => {
            // ===== Utils =====
            const clamp = (n, min, max) => Math.min(max, Math.max(min, n));
            const isByte = (n) => Number.isInteger(n) && n >= 0 && n <= 255;
            const ipToInt = (ip) => { const p = String(ip).trim().split('.').map(Number); if (p.length !== 4 || !p.every(isByte)) return null; return ((p[0] << 24) >>> 0) + (p[1] << 16) + (p[2] << 8) + p[3]; }
            const intToIp = (x) => [(x >>> 24) & 255, (x >>> 16) & 255, (x >>> 8) & 255, x & 255].join('.')
            const maskFromPrefix = (n) => n === 0 ? 0 : (0xFFFFFFFF << (32 - n)) >>> 0

            function classOf(ipInt) {
                const f = (ipInt >>> 24) & 255
                if (f <= 127) return 'A';
                if (f <= 191) return 'B';
                if (f <= 223) return 'C';
                if (f <= 239) return 'D';
                return 'E';
            }
            const defaultBitsForClass = c => c === 'A' ? 8 : c === 'B' ? 16 : c === 'C' ? 24 : 24

            // ===== DOM =====
            const el = {
                ip: document.getElementById('ip'), classTag: document.getElementById('classTag'), classless: document.getElementById('classless'), netbits: document.getElementById('netbits'),
                ipDec: document.getElementById('ipDec'), ipBin: document.getElementById('ipBin'), maskDec: document.getElementById('maskDec'), maskBin: document.getElementById('maskBin'),
                btnA: document.getElementById('btnA'), btnB: document.getElementById('btnB'), btnC: document.getElementById('btnC'),
                toggleTheme: document.getElementById('toggleTheme'),
                cidr: document.getElementById('cidr')
            }

            // ===== Render helpers =====
            function renderOctetSpan(value, octIndex, p) {
                // octIndex 0..3 de gauche √† droite, p = nb de bits r√©seau
                const startBit = octIndex * 8, endBit = startBit + 8; // 0..8, 8..16, 16..24, 24..32
                const netBitsInOct = Math.max(0, Math.min(p, endBit) - startBit);
                let cls = 'host', style = '';
                if (netBitsInOct === 8) cls = 'net';
                else if (netBitsInOct === 0) cls = 'host';
                else { cls = 'mix'; style = `--mixp:${(netBitsInOct / 8 * 100).toFixed(0)}%`; }
                return `<span class="oct ${cls}" style="${style}">${value}</span>`
            }

            function renderBigIP(ipInt, p) {
                const octs = [(ipInt >>> 24) & 255, (ipInt >>> 16) & 255, (ipInt >>> 8) & 255, ipInt & 255];
                el.ipDec.innerHTML = octs.map((v, i) => renderOctetSpan(v, i, p)).join('<span class="oct sep">.</span>');
                el.cidr.textContent = '/' + p;
            }

            function renderBigMask(p) {
                const m = maskFromPrefix(p);
                const octs = [(m >>> 24) & 255, (m >>> 16) & 255, (m >>> 8) & 255, m & 255];
                el.maskDec.innerHTML = octs.map((v, i) => renderOctetSpan(v, i, p)).join('<span class="oct sep">.</span>');
            }

            function renderBitRow(container, x, p) {
                container.innerHTML = '';
                const bits = [];
                for (let i = 31; i >= 0; i--) {
                    const isNet = (31 - i) < p; // 0..p-1 => net
                    const val = (x >> i) & 1;
                    const d = document.createElement('div');
                    d.className = 'bit ' + (isNet ? 'net' : 'host');
                    d.textContent = val;
                    bits.push(d);
                }
                const groups = [[], [], [], []];
                bits.forEach((b, idx) => { groups[Math.floor(idx / 8)].push(b) });
                groups.forEach((arr, gi) => {
                    const g = document.createElement('div'); g.className = 'bin-oct';
                    arr.forEach(b => g.appendChild(b));
                    container.appendChild(g);
                    if (gi < 3) { const sep = document.createElement('span'); sep.textContent = '.'; sep.className = 'oct-sep'; container.appendChild(sep) }
                })
            }

            function updateAll() {
                const ipInt = ipToInt(el.ip.value);
                if (ipInt === null) {
                    el.ipDec.textContent = 'Adresse invalide'; el.ipBin.textContent = ''; el.maskDec.textContent = ''; el.maskBin.textContent = ''; el.classTag.textContent = '‚Äî'; el.cidr.textContent = '';
                    return;
                }
                const cls = classOf(ipInt);
                el.classTag.textContent = `Classe ${cls}`;
                const p = el.classless.checked ? clamp(+el.netbits.value || 0, 0, 32) : defaultBitsForClass(cls);
                el.netbits.value = p;
                renderBigIP(ipInt, p);
                renderBitRow(el.ipBin, ipInt, p);
                renderBigMask(p);
                renderBitRow(el.maskBin, maskFromPrefix(p), p);
            }

            // ===== Generators =====
            const rnd = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;
            function randomByClass(cls) {
                let a, b, c, d;
                if (cls === 'A') { a = rnd(1, 126); b = rnd(0, 255); c = rnd(0, 255); d = rnd(1, 254); }
                if (cls === 'B') { a = rnd(128, 191); b = rnd(0, 255); c = rnd(0, 255); d = rnd(1, 254); }
                if (cls === 'C') { a = rnd(192, 223); b = rnd(0, 255); c = rnd(0, 255); d = rnd(1, 254); }
                return `${a}.${b}.${c}.${d}`;
            }

            // ===== Events =====
            el.ip.addEventListener('input', updateAll);
            el.classless.addEventListener('change', () => {
                el.netbits.disabled = !el.classless.checked;
                [el.btnA, el.btnB, el.btnC].forEach(btn => btn.disabled = el.classless.checked);
                updateAll();
            });
            el.netbits.addEventListener('input', updateAll);
            el.btnA.addEventListener('click', () => { el.ip.value = randomByClass('A'); el.classless.checked = false; el.netbits.disabled = true;[el.btnA, el.btnB, el.btnC].forEach(b => b.disabled = false); updateAll(); })
            el.btnB.addEventListener('click', () => { el.ip.value = randomByClass('B'); el.classless.checked = false; el.netbits.disabled = true;[el.btnA, el.btnB, el.btnC].forEach(b => b.disabled = false); updateAll(); })
            el.btnC.addEventListener('click', () => { el.ip.value = randomByClass('C'); el.classless.checked = false; el.netbits.disabled = true;[el.btnA, el.btnB, el.btnC].forEach(b => b.disabled = false); updateAll(); })

            // Th√®me + Init
            const root = document.documentElement;
            el.toggleTheme.addEventListener('click', () => { root.classList.toggle('light') });

            el.ip.value = '192.168.10.42';
            el.classless.checked = false; el.netbits.disabled = true;
            [el.btnA, el.btnB, el.btnC].forEach(b => b.disabled = false);
            updateAll();
        })
    </script>
</body>

</html>